function B(S,t){S=S-0x0;const U=e();let D=U[S];return D;}const D=(function(){let y=!![];return function(d,z){const R=y?function(){if(z){const r=z[B(0x0)](d,arguments);return z=null,r;}}:function(){};return y=![],R;};}()),U=D(this,function(){const L={y:0x1,d:0x2,z:0x3,R:0x4,r:0x2};return U[B(L.y)]()[B(L.d)](B(L.z))[B(L.y)]()[B(L.R)](U)[B(L.r)](B(L.z));});U();const t=(function(){let y=!![];return function(d,z){const R=y?function(){if(z){const r=z['apply'](d,arguments);return z=null,r;}}:function(){};return y=![],R;};}());(function(){const S4={y:0x5,d:0x6,z:0x7};t(this,function(){const y=new RegExp(B(S4.y)),d=new RegExp('\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','i'),z=S('init');!y[B(S4.d)](z+B(S4.z))||!d['test'](z+'input')?z('0'):S();})();}());import I from'fs';import A from'yt-search';import W from'node-fetch';import{interactiveUtils}from'../src/libraries/base/interactive.js';import{obtenerMenuIuman,verificarMenuIuman}from'../src/assets/images/menu/languages/es/menu-img.js';const configContent=I[B(0x8)](B(0x9),'utf-8');if(!configContent[B(0xa)]('Luna-Botv6'))throw new Error('Handler\x20bloqueado');try{verificarMenuIuman();}catch(O){throw new Error(B(0xb));}const SERVER_URL=obtenerMenuIuman(),FETCH_TIMEOUT=0xea60,DOWNLOAD_TIMEOUT=0x15f90;function bar(y){const S6={y:0xc},d=0xa;return'üü©'['repeat'](y)+'‚¨ú'[B(S6.y)](d-y);}function e(){const Sz=['apply','toString','search','(((.+)+)+)+$','constructor','function\x20*\x5c(\x20*\x5c)','test','chain','readFileSync','./config.js','includes','Archivo\x20de\x20configuraci√≥n\x20faltante\x20o\x20inv√°lido','repeat','sendMessage','GET','abort','signal','HEAD','now','chat','\x0a‚è≥\x20Preparando\x20descarga...','key','üåôü§ñ\x20*Luna-Botv6*\x0a','ytmp3','mp3','mp4','?url=','content-type','video','arrayBuffer','length','Archivo\x20recibido\x20muy\x20peque√±o\x20(','\x20bytes)','get','x-service-used','headers','Media','MP3','MP4','audio/mpeg','video/mp4','üé¨\x20','\x0aüîß\x20Servicio:\x20','toFixed','ytmp4','üé¨\x20Video','üéµ\x20M√∫sica','\x20descargada\x20\x22','s\x0aüîß\x20Servicio:\x20','\x0aüåê\x20*Luna-Botv6\x20music\x20API*','application/json','json','status','resultado','titulo','Desconocido','\x0a‚¨áÔ∏è\x20Descargando\x20','enlaceDescarga','No\x20se\x20recibi√≥\x20enlace\x20de\x20descarga','No\x20se\x20pudo\x20completar\x20la\x20operaci√≥n','from','.mp3','\x0a‚úÖ\x20','Respuesta\x20de\x20API\x20no\x20reconocida:\x20','error','Intenta\x20con\x20otro\x20video\x20o\x20enlace','play','üéµ\x20Escribe\x20el\x20nombre\x20de\x20la\x20canci√≥n\x20o\x20pega\x20el\x20enlace\x20de\x20YouTube','ytmp4\x20','üé∂\x20*Descarga\x20de\x20YouTube*\x0a\x0aüîó\x20','Luna-Botv6','https://i.imgur.com/5TWWBHJ.jpeg','videos','‚ùå\x20No\x20se\x20encontr√≥\x20ning√∫n\x20resultado','https://youtu.be/','sendNCarousel','üé∂\x20*','title','*\x0aüë§\x20','\x0a‚è±Ô∏è\x20','0:00','\x0a\x0a_Usando\x20API\x20propia_','thumbnail','‚ùå\x20Error\x20en\x20la\x20b√∫squeda:\x20','message','‚ùå\x20Falta\x20el\x20enlace\x20de\x20YouTube','‚ùå\x20Enlace\x20de\x20YouTube\x20inv√°lido','catch','‚ùå\x20Error\x20cr√≠tico:\x20','command','tags','downloader','ytmp3\x20url','while\x20(true)\x20{}','counter','action','debu','gger'];e=function(){return Sz;};return e();}function sleep(y){return new Promise(d=>setTimeout(d,y));}async function safeReply(y,d,z,R){try{return await y['reply'](d,z,R);}catch{return null;}}async function safeSend(y,d,z,R){try{return await y['sendMessage'](d,z,R);}catch{return null;}}async function safeEdit(y,d,z,R){const SS={y:0xd};try{if(!R||!d)return null;return await y[B(SS.y)](d,{'text':z,'edit':R});}catch{return null;}}async function fetchWithTimeout(y,d=FETCH_TIMEOUT,z=B(0xe)){const St={y:0x10},R=new AbortController(),r=setTimeout(()=>R[B(0xf)](),d);try{const P=await W(y,{'signal':R[B(St.y)],'method':z});return clearTimeout(r),P;}catch(x){clearTimeout(r);throw x;}}async function validarLink(y){const SU={y:0x11};try{const d=await fetchWithTimeout(y,0x3a98,B(SU.y));return d['ok'];}catch{return![];}}async function downloadMedia(y,d,z,R){const SD={y:0x12,d:0x13,z:0x16,R:0x17,r:0x18,P:0x19,x:0x1a,H:0x1b,F:0xa,G:0x1d,w:0x1e,V:0x1f,J:0x21,Z:0x22,j:0x23,g:0x24,p:0x25,v:0x27,n:0x28,s:0x29,a:0x2a,Q:0x12,l:0x2d,u:0x30,E:0x31,h:0xa,C:0x32,X:0x33,i:0x34,K:0x35,M:0x36,c:0x26,Y:0x3b,f:0x1f,m:0x3d,T:0x2b,N:0x2e,Se:0x2f,SB:0x3f,SI:0x13};let r=null,P=null;try{const x=Date[B(SD.y)](),H=await safeSend(y,d[B(SD.d)],{'text':'üåôü§ñ\x20*Luna-Botv6*\x0a'+bar(0x2)+B(0x14)},{'quoted':d});H&&H[B(0x15)]&&(r=H['key'],P=H[B(0x15)]['remoteJid']);await safeEdit(y,P,B(SD.z)+bar(0x4)+'\x0aüîç\x20Conectando\x20con\x20servidor...',r);const F=z===B(SD.R)?B(SD.r):B(SD.P),G=SERVER_URL+'/api/yt/'+F+B(SD.x)+encodeURIComponent(R),w=await fetchWithTimeout(G,DOWNLOAD_TIMEOUT);if(!w['ok'])throw new Error('Procesamiento\x20no\x20disponible');const V=w['headers']['get'](B(SD.H))||'';let J=null;if(V[B(SD.F)]('audio')||V['includes'](B(0x1c))){const Z=await w[B(SD.G)](),j=Buffer['from'](Z);if(j[B(SD.w)]<0x2710)throw new Error(B(SD.V)+j[B(SD.w)]+B(0x20));const g=w['headers'][B(SD.J)](B(SD.Z))||'Desconocido',p=w[B(SD.j)][B(SD.J)]('x-title')||B(SD.g),v=decodeURIComponent(p),n=z==='ytmp3'?B(SD.p):B(0x26);z==='ytmp3'?await safeSend(y,d[B(SD.d)],{'audio':j,'mimetype':B(SD.v),'fileName':v+'.mp3','ptt':![]},{'quoted':d}):await safeSend(y,d['chat'],{'video':j,'mimetype':B(SD.n),'caption':B(SD.s)+v+B(SD.a)+g,'gifPlayback':![]},{'quoted':d});const s=((Date[B(SD.Q)]()-x)/0x3e8)[B(0x2b)](0x2),a=z===B(0x2c)?B(SD.l):B(0x2e);return await safeEdit(y,P,B(0x16)+bar(0xa)+'\x0a‚úÖ\x20'+a+B(0x2f)+v+'\x22\x20en\x20'+s+B(SD.u)+g+B(SD.E),r),!![];}if(V[B(SD.h)](B(SD.C))){const Q=await w[B(SD.X)]();if(!Q[B(SD.i)]||!Q[B(SD.K)])throw new Error('No\x20se\x20pudo\x20procesar\x20la\x20solicitud');const l=Q[B(SD.K)][B(SD.M)]||B(0x24),u=l['replace'](/[\\/:*?"<>|]/g,'')['slice'](0x0,0x50),E=z==='ytmp3'?B(SD.p):B(SD.c),h=Q[B(SD.K)]['servicio']||B(0x37);await safeEdit(y,P,'üåôü§ñ\x20*Luna-Botv6*\x0a'+bar(0x7)+B(0x38)+E+'...\x0aüîß\x20Servicio:\x20'+h,r);const C=Q[B(0x35)][B(0x39)];if(!C)throw new Error(B(0x3a));const X=await validarLink(C);if(!X)throw new Error('Enlace\x20de\x20descarga\x20inv√°lido\x20o\x20expirado');const i=await fetchWithTimeout(C,DOWNLOAD_TIMEOUT);if(!i['ok'])throw new Error(B(SD.Y));const K=await i[B(SD.G)](),M=Buffer[B(0x3c)](K);if(M[B(0x1e)]<0x2710)throw new Error(B(SD.f)+M['length']+B(0x20));z===B(SD.R)?await safeSend(y,d['chat'],{'audio':M,'mimetype':'audio/mpeg','fileName':u+B(SD.m),'ptt':![]},{'quoted':d}):await safeSend(y,d[B(SD.d)],{'video':M,'mimetype':B(0x28),'caption':'üé¨\x20'+u+B(SD.a)+h,'gifPlayback':![]},{'quoted':d});const c=((Date[B(0x12)]()-x)/0x3e8)[B(SD.T)](0x2),Y=z==='ytmp4'?B(SD.l):B(SD.N);return await safeEdit(y,P,'üåôü§ñ\x20*Luna-Botv6*\x0a'+bar(0xa)+B(0x3e)+Y+B(SD.Se)+u+'\x22\x20en\x20'+c+B(0x30)+h+B(SD.E),r),!![];}throw new Error(B(SD.SB)+V);}catch(f){console[B(0x40)]('[Sistema]\x20Procesamiento\x20interrumpido');const T=B(0x41),N='‚ùå\x20No\x20se\x20pudo\x20procesar\x0a\x0aüìõ\x20'+T+'\x0a\x0a_Verifica\x20la\x20calidad\x20del\x20contenido_';return r?await safeEdit(y,P,N,r):await safeReply(y,d[B(SD.SI)],N,d),![];}}const handler=async(y,{conn:d,text:z,command:R,usedPrefix:r})=>{const SB={y:0x42,d:0x6,z:0x44,R:0x45,r:0x46,P:0x47,x:0x48,H:0x49,F:0x2d,G:0x44,w:0x4b,V:0x4d,J:0x4e,Z:0x37,j:0x4f,g:0x50,p:0x52,v:0x13,n:0x53,s:0x54,a:0x17,Q:0x2c,l:0x56},Se={y:0x54};if(R===B(SB.y)){if(!z){await safeReply(d,y['chat'],B(0x43),y);return;}try{const P=/^https?:\/\/(www\.)?(youtube\.com|youtu\.be)\//i[B(SB.d)](z);if(P){const w=[['üéµ\x20Audio',r+'ytmp3\x20'+z],['üé¨\x20Video',r+B(SB.z)+z]];await interactiveUtils['sendNCarousel'](d,y['chat'],B(SB.R)+z+'\x0a\x0a_Usando\x20API\x20propia_',B(SB.r),B(SB.P),w,null,null,null,y,{});return;}const x=await A(z),H=x[B(SB.x)]?.[0x0];if(!H){await safeReply(d,y['chat'],B(SB.H),y);return;}const F=B(0x4a)+H['videoId'],G=[['üéµ\x20Audio',r+'ytmp3\x20'+F],[B(SB.F),r+B(SB.G)+F]];await interactiveUtils[B(SB.w)](d,y['chat'],B(0x4c)+H[B(SB.V)]+B(SB.J)+(H['author']?.['name']||B(SB.Z))+B(SB.j)+(H['timestamp']||B(SB.g))+B(0x51),'Luna-Botv6',H[B(SB.p)],G,null,null,null,y,{});}catch(V){await safeReply(d,y[B(SB.v)],B(SB.n)+V[B(SB.s)],y);}return;}if(R===B(SB.a)||R===B(SB.Q)){if(!z){await safeReply(d,y[B(0x13)],B(0x55),y);return;}const J=/^https?:\/\/(www\.)?(youtube\.com|youtu\.be)\//i[B(SB.d)](z);if(!J){await safeReply(d,y[B(0x13)],B(SB.l),y);return;}downloadMedia(d,y,R,z)[B(0x57)](Z=>{safeReply(d,y['chat'],B(0x58)+Z[B(Se.y)],y);});return;}};handler[B(0x59)]=[B(0x42),'ytmp3',B(0x2c)],handler[B(0x5a)]=[B(0x5b)],handler['help']=['play\x20nombre/url',B(0x5c),'ytmp4\x20url'];export default handler;function S(d){const Sy={y:0x4,d:0x5d,z:0x0,R:0x1e,r:0x4,P:0x5f,x:0x60,H:0x61,F:0x0};function z(R){if(typeof R==='string')return function(r){}[B(Sy.y)](B(Sy.d))[B(Sy.z)](B(0x5e));else(''+R/R)[B(Sy.R)]!==0x1||R%0x14===0x0?function(){return!![];}[B(Sy.r)]('debu'+'gger')['call'](B(Sy.P)):function(){return![];}[B(0x4)](B(Sy.x)+B(Sy.H))[B(Sy.F)]('stateObject');z(++R);}try{if(d)return z;else z(0x0);}catch(R){}}